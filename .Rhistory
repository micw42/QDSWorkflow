se_tr = read.csv("Downloads/batch4_SE_trimmomatic_result.csv")
r1_a = se_tr %>% filter(grepl("R1", pair)) %>% select(pair, input_reads)%>%
mutate(sample=as.numeric(str_extract(pair, "[^_]+"))) %>% arrange(sample)
samples = r1_a$sample
r2_a = se_tr %>% filter(grepl("R2", pair)) %>% select(pair, input_reads)%>%
mutate(sample=as.numeric(str_extract(pair, "[^_]+"))) %>% arrange(sample)
pe = read.csv("Downloads/batch4_trimmomatic_result.csv") %>% arrange(File)
a = data.frame(sample=samples,
r1_raw=r1_a$input_reads, r2_raw=r2_a$input_reads, pe_raw=pe$input_read_pairs)
a
r1_a
se_tr = read.csv("Downloads/batch4_SE_trimmomatic_result.csv")
r1_a = se_tr %>% filter(grepl("R1", pair)) %>%
mutate(sample=as.numeric(str_extract(pair, "[^_]+"))) %>% arrange(sample)
samples = r1_a$sample
r2_a = se_tr %>% filter(grepl("R2", pair)) %>%
mutate(sample=as.numeric(str_extract(pair, "[^_]+"))) %>% arrange(sample)
pe = read.csv("Downloads/batch4_trimmomatic_result.csv") %>% arrange(File)
a = data.frame(sample=samples,
r1_raw=r1_a$input_reads, r2_raw=r2_a$input_reads, pe_raw=pe$input_read_pairs)
a
r1_a
b = data.frame(sample=sample,
r1_surv=r1_a$surviving, r2_surv=r2_a$surviving, pe_surv=pe$both_surviving)
b = data.frame(sample=samples,
r1_surv=r1_a$surviving, r2_surv=r2_a$surviving, pe_surv=pe$both_surviving)
b
r1_sep = read.csv("Downloads/batch4_R1_SE_preproc.csv")
r1_sep
r2_sep = read.csv("Downloads/batch4_R2_SE_preproc.csv")
r2_sep
r1_sep = read.csv("Downloads/batch4_R1_SE_preproc.csv") %>%
mutate(sample=as.numeric(str_extract(Sequence.information, "[^_]+"))) %>% arrange(sample)
r2_sep = read.csv("Downloads/batch4_R2_SE_preproc.csv") %>%
mutate(sample=as.numeric(str_extract(Sequence.information, "[^_]+"))) %>% arrange(sample)
r2_sep
arrange_sample = function(df, arr_col) {
df_arr = df %>%
mutate(sample=as.numeric(str_extract(!!sym(arr_col), "[^_]+"))) %>% arrange(sample)
return(df_arr)
}
r1_a = se_tr %>% filter(grepl("R1", pair)) %>% arrange_sample(arr_col="pair")
r1_a
se_tr = read.csv("Downloads/batch4_SE_trimmomatic_result.csv")
r1_a = se_tr %>% filter(grepl("R1", pair)) %>% arrange_sample(arr_col="pair")
samples = r1_a$sample
r2_a = se_tr %>% filter(grepl("R2", pair)) %>% arrange_sample(arr_col="pair")
pe = read.csv("Downloads/batch4_trimmomatic_result.csv") %>% arrange(File)
a = data.frame(sample=samples,
r1_raw=r1_a$input_reads, r2_raw=r2_a$input_reads, pe_raw=pe$input_read_pairs)
a
pe_sep = read.csv("Downloads/batch4_PE_R2Adapt_valid.csv")
pe_sep
pe_sep = read.csv("Downloads/batch4_PE_R2Adapt_valid.csv")
pe_sep
pe_sep = read.csv("Downloads/batch4_PE_R2Adapt_valid.csv") %>% arrange_sample()
read.csv("Downloads/batch4_PE_R2Adapt_valid.csv")
r1_sep = read.csv("Downloads/batch4_R1_SE_preproc.csv") %>% arrange_sample(arr_col = "Sequence.information")
r2_sep = read.csv("Downloads/batch4_R2_SE_preproc.csv") %>% arrange_sample(arr_col = "Sequence.information")
pe_sep = read.csv("Downloads/batch4_PE_R2Adapt_valid.csv") %>% arrange_sample(arr_col = "Sequence.information")
r1_sep
r2_sep
pe_sep
b2 = data.frame(sample=samples, r1_val=r1_sep$Valid.sequences,
r2_val=r2_sep$Valid.sequences, pe_val=pe_sep$Valid.sequences)
r1_sep
r2_sep
pe_sep
r1_sep = read.csv("Downloads/batch4_R1_SE_preproc.csv") %>% arrange_sample(arr_col = "Sequence.information")
r2_sep = read.csv("Downloads/batch4_R2_SE_preproc.csv") %>% arrange_sample(arr_col = "Sequence.information")
pe_sep = (read.csv("Downloads/batch4_PE_R2Adapt_valid.csv") %>% arrange_sample(arr_col = "Sequence.information"))
b2 = data.frame(sample=samples, r1_val=r1_sep$Valid.sequences,
r2_val=r2_sep$Valid.sequences, pe_val=pe_sep$Valid.sequences[-nrow(pe_sep)])
b2
r1_raw = read.csv("Downloads/batch4_R1_SE_raw.csv")
r1_raw
colSums(r1_raw[,-c(1,2)])
colSums(r1_raw[,c(-1,-2)])
r1_raw
c = read.csv("Downloads/batch4_PE_R2Adapt_counts.csv")
c
c = read.csv("r1_r2_pe_mapped_counts.csv")
c
Reduce(inner_join, list(a, b, b2, c), by="sample")
Reduce(inner_join, list(a, b, b2, c))
pe_df = read.csv("Downloads/batch4_PE_R2Adapt_counts.csv")
r2_df = read.csv("Downloads/batch4_R2_SE_raw.csv")
r2_df
pe_df = read.csv("Downloads/batch4_PE_R2Adapt_counts.csv")
r2_df = read.csv("Downloads/batch4_R2_SE_raw.csv")
r2_df
pe_df = read.csv("Downloads/batch4_PE_R2Adapt_counts.csv")
r2_df = read.csv("Downloads/batch4_R2_SE_raw.csv")
pe_map = which(pe_df$X1_join!=0)
r2_map = which(r2_df$X1_join!=0)
length(pe_map)
length(r2_map)
pe_df = read.csv("Downloads/batch4_PE_R2Adapt_counts.csv")
r2_df = read.csv("Downloads/batch4_R2_SE_raw.csv")
pe_map = which(pe_df$X1_join!=0)
r2_map = which(r2_df$X1_R2_adapt10!=0)
length(r2_map)
setdiff(r2_map, pe_map)
setdiff(pe_map, r2_map)
df = Reduce(inner_join, list(a, b, b2, c))
df
df = Reduce(inner_join, list(a, b, b2, c))
write.csv(df, "batch4_summary.csv", row.names = F)
df
df %>% filter(pe_val > r2_val)
df %>% filter(PE_sum > R2_sum)
df = read.csv("Downloads/Liver_readcount_df.csv")
df
df %>% filter(Description=="PLA2G2A" | Description=="SP1")
normal_deseq = function(full_df, cond_df) {
dds <- DESeqDataSetFromMatrix(countData = full_df, colData = cond_df, design = ~ 1)
vsd <- DESeq2::varianceStabilizingTransformation(dds)
vsd = as.data.frame(assay(vsd))
return(vsd)
}
library(tidyverse)
df %>% select(-one_of("X", "id", "Name")) %>% column_to_rownames(var="Description")
df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
cond_df = read.csv("Downloads/pla2_samples.csv")
cond_df
gsub("-", ".", "GTEX-1117F-0226-SM-5GZZ7")
cond_df = read.csv("Downloads/pla2_samples.csv") %>%
mutate(sample=gsub("-", ".", sample))
cond_df
cond_df = read.csv("Downloads/pla2_samples.csv") %>%
mutate(sample=gsub("-", ".", sample)) %>%
dplyr::slice(match(colnames(df), sample))
cond_df
cond_df = read.csv("Downloads/pla2_samples.csv") %>%
mutate(sample=gsub("-", ".", sample)) %>%
dplyr::slice(match(sample, colnames(df)))
cond_df
colnames(df)
cond_df$sample
cond_df = read.csv("Downloads/pla2_samples.csv") %>%
mutate(sample=gsub("-", ".", sample))
cond_df$sample
intersect(colnames(df), cond_df$sample)
df
cond_df = read.csv("Downloads/pla2_samples.csv")
cond_df
cond_df = read.csv("Downloads/pla2_samples.csv")
cond_df
cond_df %>% distinct(subject)
cond_df %>% filter(grepl("11DXZ", subject))
cond_df %>% filter(grepl("1117F", subject))
cond_df %>% filter(grepl("11EQ9", subject))
gsub(".", "-", "GTEX.11DXZ.0126.SM.5EGGY")
gsub("/.", "-", "GTEX.11DXZ.0126.SM.5EGGY")
gsub("\.", "-", "GTEX.11DXZ.0126.SM.5EGGY")
gsub("\\.", "-", "GTEX.11DXZ.0126.SM.5EGGY")
strsplit("GTEX-11DXZ-0126-SM-5EGGY", "\\.")
strsplit("GTEX.11DXZ.0126.SM.5EGGY", "\\.")
head(colnames(df))
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
head(colnames(df))
strsplit(colnames(df), ".\\")
strsplit(colnames(df), "\\.")
strsplit(colnames(df), "\\.") %>% sapply("[[", 1)
strsplit(colnames(df), "\\.") %>% sapply("[[", 2)
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
colnames(df) = strsplit(colnames(df), "\\.") %>% sapply("[[", 2)
df
cond_df = read.csv("Downloads/pla2_samples.csv")
cond_df
cond_df = read.csv("Downloads/pla2_samples.csv")
cond_df$subject = strsplit(cond_df$subject, "-") %>% sapply("[[", 2)
cond_df
intersect(colnames(df), cond_df$subject)
setdiff(colnames(df), cond_df$subject)
setdiff(colnames(df), cond_df$subject) %>% length()
ncol(df)
setdiff(colnames(df), cond_df$subject) %>% length()
intersect(colnames(df), cond_df$subject) %>% length()
cond_df %>% dplyr::slice(match(colnames(df), subject))
geno_df = read.csv("Downloads/pla2_samples.csv")
geno_df$subject = strsplit(geno_df$subject, "-") %>% sapply("[[", 2)
cond_df = data.frame(subject=colnames(df))
left_join(cond_df, geno_df, by="subject")
cond_df = data.frame(subject=colnames(df)) %>% left_join(geno_df, by="subject")
cond_df
cond_df %>% filter(!is.na(geno))
cond_df %>% filter(is.na(geno))
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
colnames(df) = gsub(".", "-", colnames(df))
df
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
colnames(df) = gsub("\\.", "-", colnames(df))
df
missing = cond_df %>% filter(is.na(geno)) %>% pull(subject)
colnames(df)[grepl(subject, colnames(df))]
colnames(df)[grepl(missing, colnames(df))]
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
full_names = colnames(df)
colnames(df) = strsplit(colnames(df), "\\.") %>% sapply("[[", 2)
geno_df = read.csv("Downloads/pla2_samples.csv")
geno_df$subject = strsplit(geno_df$subject, "-") %>% sapply("[[", 2)
cond_df = data.frame(subject=colnames(df), full_name=full_names) %>% left_join(geno_df, by="subject")
cond_df %>% filter(is.na(geno))
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
full_names = gsub("\\.", "-", colnames(df))
colnames(df) = strsplit(colnames(df), "\\.") %>% sapply("[[", 2)
geno_df = read.csv("Downloads/pla2_samples.csv")
geno_df$subject = strsplit(geno_df$subject, "-") %>% sapply("[[", 2)
cond_df = data.frame(subject=colnames(df), full_name=full_names) %>% left_join(geno_df, by="subject")
cond_df %>% filter(is.na(geno))
missing = cond_df %>% filter(is.na(geno)) %>% pull(full_name)
write(missing, "missing_geno.txt", sep="\n")
cond_df = read.csv("Downloads/pla2_samples.csv")
cond_df
cond_df %>% distinct(subject)
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
full_names = gsub("\\.", "-", colnames(df))
colnames(df) = strsplit(colnames(df), "\\.") %>% sapply("[[", 2)
geno_df = read.csv("Downloads/pla2_samples.csv")
geno_df$subject = strsplit(geno_df$subject, "-") %>% sapply("[[", 2)
cond_df = data.frame(subject=colnames(df), full_name=full_names) %>% left_join(geno_df, by="subject")
cond_df %>% filter(is.na(geno))
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
full_names = gsub("\\.", "-", colnames(df))
colnames(df) = strsplit(colnames(df), "\\.") %>% sapply("[[", 2)
geno_df = read.csv("Downloads/pla2_samples.csv")
geno_df$subject = strsplit(geno_df$subject, "-") %>% sapply("[[", 2)
cond_df = data.frame(subject=colnames(df), full_name=full_names) %>% left_join(geno_df, by="subject")
cond_df %>% filter(is.na(geno))
files = paste0("Downloads/", c("getx_v8", "colon", "liver", "prost", "small_int", "adipose_vis", "colon_sig"), ".csv")
df_list = lapply(files, FUN=read.csv)
files = paste0("Downloads/", c("gtex_v8", "colon", "liver", "prost", "small_int", "adipose_vis", "colon_sig"), ".csv")
df_list = lapply(files, FUN=read.csv)
df_list
full_df = bind_rows(df_list)
full_df
full_df = bind_rows(df_list) %>% distinct(subject, .keep_all = T) %>% select(subject, rs11573156_GT) %>%
dplyr::rename(geno=rs11573156_GT)
full_df
write.csv(full_df, "pla2_samples.csv", row.names = F)
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
full_names = gsub("\\.", "-", colnames(df))
colnames(df) = strsplit(colnames(df), "\\.") %>% sapply("[[", 2)
geno_df = read.csv("pla2_samples.csv")
geno_df$subject = strsplit(geno_df$subject, "-") %>% sapply("[[", 2)
cond_df = data.frame(subject=colnames(df), full_name=full_names) %>% left_join(geno_df, by="subject")
cond_df %>% filter(is.na(geno))
missing = cond_df %>% filter(is.na(geno)) %>% pull(full_name)
write(missing, "missing_geno.txt", sep="\n")
length(missing)
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
full_names = gsub("\\.", "-", colnames(df))
colnames(df) = strsplit(colnames(df), "\\.") %>% sapply("[[", 2)
geno_df = read.csv("pla2_samples.csv")
geno_df$subject = strsplit(geno_df$subject, "-") %>% sapply("[[", 2)
cond_df = data.frame(subject=colnames(df), full_name=full_names) %>% inner_join(geno_df, by="subject")
cond_df
df = read.csv("Downloads/Liver_readcount_df.csv")
df = df %>% select(-one_of("X", "id", "Name")) %>% distinct(Description, .keep_all = T) %>%
column_to_rownames(var="Description")
full_names = gsub("\\.", "-", colnames(df))
colnames(df) = strsplit(colnames(df), "\\.") %>% sapply("[[", 2)
geno_df = read.csv("pla2_samples.csv")
geno_df$subject = strsplit(geno_df$subject, "-") %>% sapply("[[", 2)
cond_df = data.frame(subject=colnames(df), full_name=full_names) %>% inner_join(geno_df, by="subject") %>%
column_to_rownames(var="subject")
cond_df
df
df = df %>% select(rownames(cond_df))
df
des_df = normal_deseq(df, cond_df)
library(DESeq2)
des_df = normal_deseq(df, cond_df)
des_df
saveRDS(des_df, "pla2_vst.rds")
des_df["PLA2G2A",]
pla2_df = data.frame(pla2=des_df["PLA2G2A",],
sp1=des_df["SP1",],
geno=cond_df$geno)
pla2_df
as.vector(des_df["PLA2G2A",])
pla2_df = data.frame(pla2=as.numeric(des_df["PLA2G2A",]),
sp1=as.numeric(des_df["SP1",]),
geno=cond_df$geno)
pla2_df
library(ggplot2)
pla2_df %>%
ggplot(aes(pla2,sp1, color=geno)) +
geom_point(alpha=0.5, size=2) +
labs(y="SP1", x="PLA2G2A")
cond_df
pla2_df %>% group_by(geno) %>% group_split()
pla2_df %>% group_by(geno) %>%
group_split() %>%
lapply(FUN=function(x) cor(x$pla2, x$sp1))
cors = pla2_df %>% group_by(geno) %>%
group_split() %>%
lapply(FUN=function(x) cor(x$pla2, x$sp1))
genos = cors = pla2_df %>% group_by(geno) %>%
group_split() %>%
lapply(FUN=function(x) x$geno[1])
setNames(cors, genos)
cors = pla2_df %>% group_by(geno) %>%
group_split() %>%
lapply(FUN=function(x) cor(x$pla2, x$sp1))
genos = pla2_df %>% group_by(geno) %>%
group_split() %>%
lapply(FUN=function(x) x$geno[1])
cors = setNames(cors, genos)
cors
title = paste0("C/C cor: ", round(cors[["C/C"]], 2),
"\nG/C cor: ", round(cors[["G/C"]], 2),
"\nG/G cor: ", round(cors[["G/G"]], 2))
pla2_df %>%
ggplot(aes(pla2,sp1, color=geno)) +
geom_point(alpha=0.5, size=2) +
labs(y="SP1", x="PLA2G2A") +
ggtitle(title)
pla2_df %>%
ggplot(aes(pla2,sp1, color=geno)) +
geom_point(alpha=0.5, size=2) +
labs(y="SP1", x="PLA2G2A", subtitle=title) +
ggtitle("PLA2G2A vs SP1 VST Counts")
read.delim("featureCounts_REF_human.txt")
read.delim("featureCounts_files/featureCounts_REF_human.txt")
lc_ann= readRDS("lung_cancer_ann.txt")
setwd("QDSWorkflow/")
usethis::use_data(lc_ann)
lc_ann
getwd()
devtools::load_all()
setwd("QDSWorkflow/")
devtools::load_all()
musc_raw
df = musc_raw %>% format_cols()
df
df = musc_raw %>% format_cols()
df==0
warning("warning")
devtools::load_all()
df = readRDS("musc_regen_test.rds")
PrebuiltQDSModel(df)
devtools::load_all()
df = readRDS("musc_regen_test.rds")
PrebuiltQDSModel(df)
devtools::load_all()
df = readRDS("musc_regen_test.rds")
PrebuiltQDSModel(df)
devtools::load_all()
df = readRDS("musc_regen_test.rds")
PrebuiltQDSModel(df)
devtools::load_all()
df = readRDS("musc_regen_test.rds")
PrebuiltQDSModel(df)
devtools::load_all()
df = readRDS("musc_regen_test.rds")
PrebuiltQDSModel(df)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
ref_raw
ref_raw = data.table::fread("featureCounts_REF_final.txt")
ref_raw
ref_raw = data.table::fread("featureCounts_REF_final.txt")
usethis::use_data(ref_raw)
ref_raw = data.table::fread("featureCounts_REF_final.txt")
setwd("QDSWorkflow/")
usethis::use_data(ref_raw)
ref_raw = data.table::fread("featureCounts_REF_final.txt")
setwd("QDSWorkflow/")
usethis::use_data(ref_raw, overwrite = T)
devtools::document()
ref_ann = data.table::fread("REF_ann_withDay.txt")
setwd("QDSWorkflow/")
usethis::use_data(ref_ann, overwrite = T)
devtools::document()
lc_ann
lc_ann = lc_ann %>%
mutate(Development_Stage=case_when(Sample_Origin=="nLung" ~"normal lung",
Sample_Origin=="tLung" ~"lung tumor (early)",
Sample_Origin=="tL/B" ~"lung tumor (late)",
Sample_Origin=="mLN" ~"lymph node (metastasis)",
Sample_Origin=="PE" ~"pleural effusion (metastasis)",
Sample_Origin=="mBrain" ~"brain (metastasis)"))
lc_ann
lc_ann = lc_ann %>%
mutate(Development_Stage=case_when(Sample_Origin=="nLung" ~"normal lung",
Sample_Origin=="tLung" ~"lung tumor (early)",
Sample_Origin=="tL/B" ~"lung tumor (late)",
Sample_Origin=="mLN" ~"lymph node (metastasis)",
Sample_Origin=="PE" ~"pleural effusion (metastasis)",
Sample_Origin=="mBrain" ~"brain (metastasis)"))
setwd("QDSWorkflow/")
usethis::use_data(lc_ann, overwrite = T)
devtools::document()
lc_ann = lc_ann %>%
mutate(Development_Stage=case_when(Sample_Origin=="nLung" ~"normal lung",
Sample_Origin=="tLung" ~"lung tumor (early)",
Sample_Origin=="tL/B" ~"lung tumor (late)",
Sample_Origin=="mLN" ~"lymph node (metastasis)",
Sample_Origin=="PE" ~"pleural effusion (metastasis)",
Sample_Origin=="mBrain" ~"brain (metastasis)")) %>%
mutate(Development_Stage=factor(Development_Stage, ordered = T, levels=c("normal lung", "lung tumor (early)",
"lung tumor (late)", "mLN" ~"lymph node (metastasis)",
"pleural effusion (metastasis)", "brain (metastasis)")))
setwd("QDSWorkflow/")
usethis::use_data(lc_ann, overwrite = T)
devtools::document()
devtools::document()
lc_ann = lc_ann %>%
mutate(Development_Stage=case_when(Sample_Origin=="nLung" ~"normal lung",
Sample_Origin=="tLung" ~"lung tumor (early)",
Sample_Origin=="tL/B" ~"lung tumor (late)",
Sample_Origin=="mLN" ~"lymph node (metastasis)",
Sample_Origin=="PE" ~"pleural effusion (metastasis)",
Sample_Origin=="mBrain" ~"brain (metastasis)")) %>%
mutate(Development_Stage=factor(Development_Stage, ordered = T, levels=c("normal lung", "lung tumor (early)",
"lung tumor (late)", "lymph node (metastasis)",
"pleural effusion (metastasis)", "brain (metastasis)")))
setwd("QDSWorkflow/")
usethis::use_data(lc_ann, overwrite = T)
lc_ann
lc_ann %>% pull(Development_Stage) %>% unique()
lc_ann = lc_ann %>%
mutate(Development_Stage=case_when(Sample_Origin=="nLung" ~"normal lung",
Sample_Origin=="tLung" ~"lung tumor (early)",
Sample_Origin=="tL/B" ~"lung tumor (late)",
Sample_Origin=="mLN" ~"lymph node (metastasis)",
Sample_Origin=="PE" ~"pleural effusion (metastasis)",
Sample_Origin=="mBrain" ~"brain (metastasis)")) %>%
mutate(Development_Stage=factor(Development_Stage, ordered = T, levels=c("normal lung", "lung tumor (early)",
"lung tumor (late)", "lymph node (metastasis)",
"pleural effusion (metastasis)", "brain (metastasis)")))
setwd("QDSWorkflow/")
usethis::use_data(lc_ann, overwrite = T)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
test_df = musc_raw %>% BulkPreproc() %>%
convertSpecies(hm=mouse_rat_hm, old_id = "Gene stable ID", new_id = "Rat gene stable ID")
train_df = ref_raw %>% BulkPreproc()
qds_df = QDS(train_df = train_df, test_df = test_df, ann_df = ref_ann, y_col = "Day")
make_boxplot(qds_df, musc_ann, "Condition", title="QDS of muscle stem cells \n under different perfusion conditions")
test_df = musc_raw %>% BulkPreproc() %>%
convertSpecies(hm=mouse_rat_hm, old_id = "Gene stable ID", new_id = "Rat gene stable ID")
test_df = readRDS("musc_regen_test.rds")
train_df = ref_raw %>% BulkPreproc()
qds_df = QDS(train_df = train_df, test_df = test_df, ann_df = ref_ann, y_col = "Day")
make_boxplot(qds_df, musc_ann, "Condition", title="QDS of muscle stem cells \n under different perfusion conditions")
devtools::load_all()
train_df = ref_raw %>% BulkPreproc()
test_df = data.table::fread("featureCounts_files/featureCounts_RS2.txt") %>% BulkPreproc() %>%
convertSpecies(hm = rat_human_hm, old_id = "Gene stable ID", new_id = "Rat gene stable ID")
train_df = ref_raw %>% BulkPreproc()
test_df = readRDS("musc_regen_test.rds")
out = QDS(train_df, test_df, ann_df = ref_ann, y_col = "Day")
out[[2]]
model = out[[2]]
mod_nzc = extract_nzc(model, lm=model$lambda.min, family = "gaussian")
lj_model = readRDS("QDSWorkflow/inst/extdata/ref_model.rds")
lj_nzc = extract_nzc(lj_model, lm=lj_model$lambda.min, family = "gaussian")
intersect(mod_nzc, lj_nzc) %>% length()
usethat::use_vignette("introduction")
library(usethat)
usethis::use_vignette("introduction")
devtools::load_all()
devtools::document()
library(QDSWorkflow)
#data already loaded in variable musc_raw
test_df = musc_raw %>% BulkPreproc()    #normalize
test_df = test_df %>% convertSpecies(hm=mouse_rat_hm, old_id = "Gene stable ID", new_id = "Rat gene stable ID")
qds_df = PrebuiltQDSModel(test_df)
#Muscle regeneration dataset metadata already loaded in variable musc_ann
make_boxplot(qds_df, musc_ann, "Condition", title="QDS of muscle stem cells \n under different perfusion conditions")
#Filter doublets
#Lung cancer epithelial metadata already loaded in variable lc_ann
test_df = lc_raw %>% FilterDoublets(ann_df=lc_ann, split.by="Sample", id_col="Index")
#Load the data
test_df = readRDS("../../Lung_Cancer_Epithelial_raw.rds")
devtools::install("QDSWorkflow")
devtools::document(``)
devtools::document(`)
devtools::document()
devtools::install("QDSWorkflow")
devtools::install()
